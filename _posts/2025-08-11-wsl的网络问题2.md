---
published: true
title: WSL的网络问题(2)
layout: post
author: angbo
date: 2025-08-11 21:00:00 +0800
category: wsl
tags: wsl
comments: no
---

## 问题一：`ip a` 只显示一个 lo 网络适配器

### 解决方法：删除 `.wslconfig` 文件

首先尝试删除 Windows 用户目录下的 `.wslconfig` 文件。

> **注意：**
> 如果删除并重启后遇到 “wsl: 检测到 localhost 代理配置，但未镜像到 WSL。NAT 模式下的 WSL 不支持 localhost 代理” 的错误，这可能是由于以前安装的 `VMware` 没有完全卸载干净。
>
> **解决方案：**
> 1.  打开 Windows 的设备管理器，检查网络适配器是否出现问题（例如，报错“代码56”）。
> 2.  如果有问题，打开注册表 (regedit)，删除 `HKEY_CLASSES_ROOT\CLSID\{3d09c1ca-2bcc-40b7-b9bb-3f3ec143a87b}` 项。
>
> 这个方法也适用于其他因网络适配器导致“代码56”错误的情况。

## 问题二：提示 “localhost 代理配置未镜像到 WSL”

如果只遇到 “检测到 localhost 代理配置，但未镜像到 WSL。NAT 模式下的 WSL 不支持 localhost 代理” 的问题，请按以下步骤操作：

1.  **创建 `.wslconfig` 文件**
    在您的 Windows 用户目录（通常是 `C:\Users\你的用户名\`）下创建一个新的文本文件，并将其命名为 `.wslconfig`。

2.  **编辑 `.wslconfig` 文件**
    在文件中输入以下内容：
    ```ini
    [experimental]
    autoMemoryReclaim=gradual
    networkingMode=mirrored
    dnsTunneling=true
    firewall=true
    autoProxy=true
    ```

3.  **重启 WSL 服务**
    打开 `PowerShell` 或 `CMD`，输入以下命令来关闭 WSL：
    ```bash
    wsl --shutdown
    ```
    关闭后，重新打开您的 WSL 发行版即可。

4.  **检查网络连接**
    > 如果重启后遇到无法访问外部网络的问题，请详见另一篇文章：[《WSL的网络问题(1)》](./2025-08-11-wsl的网络问题1.md)。